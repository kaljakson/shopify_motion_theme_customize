{%- assign image_count = 0 -%}
{% if block.settings.enable_image_1 %}
  {%- assign image_count = image_count | plus: 1 -%}
{% endif %}
{% if block.settings.enable_image_2 %}
  {%- assign image_count = image_count | plus: 1 -%}
{% endif %}
{% if block.settings.enable_image_3 %}
  {%- assign image_count = image_count | plus: 1 -%}
{% endif %}

<div
  data-subsection
  data-section-id="{{ block.id }}"
  data-section-type="fading-images"
  data-interval="{{ block.settings.slide_speed | times: 1000 }}"
  data-count="{{ image_count }}">

  {% style %}
  .fading-images--{{ block.id }} .fading-images-overlay__title {
    font-size: {{ block.settings.title_size | times: 0.5 }}px;
  }
  @media only screen and (min-width: 590px) {
    .fading-images--{{ block.id }} .fading-images-overlay__title {
      font-size: {{ block.settings.title_size }}px;
    }
  }
  .fading-images--{{ block.id }}.fading-images-overlay__overlay::before {
    background-color: {{ block.settings.color_overlay }};
    opacity: {{ block.settings.color_overlay_opacity | divided_by: 100.0 }};
  }
  .fading-images--{{ block.id }} .active-image {
    animation-duration: {{ block.settings.slide_speed | times: 1000 }}ms;
  }
  .fading-images--{{ block.id }} .active-image.compensation {
    animation-duration: {{ block.settings.slide_speed | times: 1000 | plus: 400 }}ms;
  }
  .fading-images--{{ block.id }} .finished-image {
    animation-duration: 1000ms;
  }
  {% endstyle %}

  <div class="fading-images fading-images--{{ block.id }} fading-images--{{ block.settings.section_height }} fading-images-overlay__overlay loading">
    <div class="fading-images-overlay__inner">
      <div class="page-width text-center">
        <div class="fading-images-overlay__titles">
          <div class="animation-cropper">
            <div class="fading-images-overlay__title fading-images-overlay__title--1"></div>
          </div>
          {% if block.settings.title_lines == "2" %}
          <div class="animation-cropper">
            <div class="fading-images-overlay__title fading-images-overlay__title--2"></div>
          </div>
          {% endif %}
        </div>
      </div>
    </div>

    {%- assign image_index = 0 -%}

    {% if block.settings.enable_image_1 %}
      {%- assign image_index = image_index | plus: 1 -%}
      {% if block.settings.image_1 != blank %}
        <div
          class="fading-images__item fading-images__item--{{ block.id }} lazyload"
          data-bgset="{% include 'bgset', image: block.settings.image_1 %}"
          data-sizes="auto"
          data-slide-index="{{ image_index }}"
          data-slide-title1="{{ block.settings.slide_title_1a }}"
          data-slide-title2="{{ block.settings.slide_title_1b }}"
          style="background-position: {{ block.settings.focal_point_1 }};">
        </div>
      {% else %}
        {% capture placeholder %}lifestyle-{% cycle 1,2 %}{% endcapture %}
        <div class="fading-images__item fading-images__item--{{ block.id }} lazyloaded"
          data-slide-index="{{ image_index }}"
          data-slide-title1="{{ block.settings.slide_title_1a }}"
          data-slide-title2="{{ block.settings.slide_title_1b }}">
            {{ placeholder | placeholder_svg_tag: 'placeholder-svg' }}
        </div>
      {% endif %}
    {% endif %}

    {% if block.settings.enable_image_2 %}
      {%- assign image_index = image_index | plus: 1 -%}
      {% if block.settings.image_2 != blank %}
        <div
          class="fading-images__item fading-images__item--{{ block.id }} lazyload"
          data-bgset="{% include 'bgset', image: block.settings.image_2 %}"
          data-sizes="auto"
          data-slide-index="{{ image_index }}"
          data-slide-title1="{{ block.settings.slide_title_2a }}"
          data-slide-title2="{{ block.settings.slide_title_2b }}"
          style="background-position: {{ block.settings.focal_point_2 }};">
        </div>
      {% else %}
        {% capture placeholder %}lifestyle-{% cycle 1,2 %}{% endcapture %}
        <div class="fading-images__item fading-images__item--{{ block.id }} lazyloaded"
          data-slide-index="{{ image_index }}"
          data-slide-title1="{{ block.settings.slide_title_2a }}"
          data-slide-title2="{{ block.settings.slide_title_2b }}">
            {{ placeholder | placeholder_svg_tag: 'placeholder-svg' }}
        </div>
      {% endif %}
    {% endif %}

    {% if block.settings.enable_image_3 %}
      {%- assign image_index = image_index | plus: 1 -%}
      {% if block.settings.image_3 != blank %}
        <div
          class="fading-images__item fading-images__item--{{ block.id }} lazyload"
          data-bgset="{% include 'bgset', image: block.settings.image_3 %}"
          data-sizes="auto"
          data-slide-index="{{ image_index }}"
          data-slide-title1="{{ block.settings.slide_title_3a }}"
          data-slide-title2="{{ block.settings.slide_title_3b }}"
          style="background-position: {{ block.settings.focal_point_3 }};">
        </div>
      {% else %}
        {% capture placeholder %}lifestyle-{% cycle 1,2 %}{% endcapture %}
        <div class="fading-images__item fading-images__item--{{ block.id }} lazyloaded"
          data-slide-index="{{ image_index }}"
          data-slide-title1="{{ block.settings.slide_title_3a }}"
          data-slide-title2="{{ block.settings.slide_title_3b }}">
            {{ placeholder | placeholder_svg_tag: 'placeholder-svg' }}
        </div>
      {% endif %}
    {% endif %}
  </div>

</div>
